<!DOCTYPE html>
<html>

<style>
body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-family: sans-serif;
}

.connect_button {
    background-color: white;
    border: 1px solid blue;
    border-radius: 1rem;
    font-size: 1.2rem;
}

.button_container {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    grid-column-gap: 0px;
    grid-row-gap: 0px;
    width: 50%;
}

.up_button {
    grid-area: 1 / 2 / 2 / 3;
}
.right_button {
    grid-area: 2 / 3 / 3 / 4;
}
.down_button {
    grid-area: 3 / 2 / 4 / 3;
}
.left_button {
    grid-area: 2 / 1 / 3 / 2;
}

.move_button {
    background-color: white;
    border: 5px solid blue;
    border-radius: 100%;
    width: 5rem;
    height: 5rem;
    font-size: 2rem;
}

button:active {
    background-color: rgb(230, 230, 230);
}
</style>




<body>

<button onclick="connect_socket()" class="connect_button">Connect</button>
<h3 id="status">Status: Disconnected</h3>

<div class="button_container">
    <button onclick="sendCommand('move_forward')" class="move_button up_button">&#8593</button>
    <button onclick="sendCommand('move_right')" class="move_button right_button">&#8594</button>
    <button onclick="sendCommand('move_down')" class="move_button down_button">&#8595</button>
    <button onclick="sendCommand('move_left')" class="move_button left_button">&#8592</button>
</div>

</body>
</html>

<script>
    let socket = undefined;

    function connect_socket() {
        // Close any existing sockets
        disconnect_socket();

        socket = new WebSocket("ws://192.168.4.1:80/connect-websocket");

        // Connection opened
        socket.addEventListener("open", (event) => {
            document.getElementById("status").textContent = "Status: Connected";
        });

        socket.addEventListener("close", (event) => {
            socket = undefined;
            document.getElementById("status").textContent = "Status: Disconnected";
        });

        socket.addEventListener("message", (event) => {
            console.log(event.data)
        });

        socket.addEventListener("error", (event) => {
            socket = undefined;
            document.getElementById("status").textContent = "Status: Disconnected";
        });
    }

    function disconnect_socket() {
        if(socket != undefined) {
            socket.close();
        }
    }

    function sendCommand(command) {
        if(socket != undefined) {
            socket.send(command)
        } else {
            alert("Not connected to the PICO")
        }
    }
</script>